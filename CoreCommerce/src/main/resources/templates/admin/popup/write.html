<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="layout/head :: head"></head>

<body class="bg-light">

<div th:replace="layout/header :: header"></div>

<div class="container py-5" style="max-width:700px;">

    <div class="card shadow-lg border-0 rounded-4">
        <div class="card-body p-5">

            <h3 class="mb-4"
                th:text="${popup.id == null} ? 'ğŸ“¢ íŒì—… ë“±ë¡' : 'ğŸ“¢ íŒì—… ìˆ˜ì •'">
            </h3>

            <form th:action="@{/admin/popup/save}"
                  method="post"
                  enctype="multipart/form-data">

                <input type="hidden"
                       name="id"
                       th:value="${popup.id}">

                <!-- ========================= -->
                <!-- ì œëª© -->
                <!-- ========================= -->
                <div class="mb-3">
                    <label class="form-label">ì œëª©</label>
                    <input type="text"
                           name="title"
                           class="form-control"
                           th:value="${popup.title}"
                           required>
                </div>

                <!-- ========================= -->
                <!-- ë§í¬ -->
                <!-- ========================= -->
                <div class="mb-3">
                    <label class="form-label">ë§í¬</label>
                    <input type="text"
                           name="linkUrl"
                           class="form-control"
                           th:value="${popup.linkUrl}">
                </div>

                <!-- ========================= -->
                <!-- ë‚ ì§œ (ğŸ”¥ null ì•ˆì „ ì²˜ë¦¬ ì¶”ê°€) -->
                <!-- ========================= -->
                <div class="row">

                    <div class="col-md-6">
                        <label class="form-label">ì‹œì‘ì¼</label>

                       <input type="datetime-local"
						       name="startDate"
						       class="form-control"
						       step="1"
						       th:value="${popup.startDate != null
						                  ? #temporals.format(popup.startDate,'yyyy-MM-dd''T''HH:mm')
						                  : ''}">
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">ì¢…ë£Œì¼</label>

                        <input type="datetime-local"
						       name="endDate"
						       class="form-control"
						       step="1"
						       th:value="${popup.endDate != null
						                  ? #temporals.format(popup.endDate,'yyyy-MM-dd''T''HH:mm')
						                  : ''}">
                    </div>

                </div>

                <!-- ========================= -->
                <!-- ìƒíƒœ -->
                <!-- ========================= -->
                <div class="mt-3">
                    <label class="form-label">ì‚¬ìš© ì—¬ë¶€</label>

                    <select name="isActive"
                            class="form-select">

                        <option value="true"
                                th:selected="${popup.isActive == true}">
                            ì‚¬ìš©
                        </option>

                        <option value="false"
                                th:selected="${popup.isActive == false}">
                            ë¯¸ì‚¬ìš©
                        </option>

                    </select>
                </div>

                <!-- ========================= -->
                <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ -->
                <!-- ========================= -->
               <div class="mt-3">
				    <label class="form-label">ì´ë¯¸ì§€ ì—…ë¡œë“œ</label>
				
				    <!-- ğŸ”¥ íŒŒì¼ ì„ íƒ -->
				    <input type="file"
				           name="file"
				           class="form-control"
				           accept="image/*"
				           onchange="preview(event)">
				
				    <!-- ğŸ”¥ ê¸°ì¡´ ì´ë¯¸ì§€ ìœ ì§€ìš© (ì¤‘ìš”) -->
				    <input type="hidden"
				           name="imageUrl"
				           th:value="${popup.imageUrl}">
				
				</div>

                <!-- ========================= -->
                <!-- ê¸°ì¡´ ì´ë¯¸ì§€ -->
                <!-- ========================= -->
                <div th:if="${popup.imageUrl != null}"
                     class="mt-4 text-center">

                    <p class="fw-bold">í˜„ì¬ ì´ë¯¸ì§€</p>

                    <img th:src="@{${popup.imageUrl}}"
                         class="rounded-3"
                         style="width:250px;">

                </div>

                <!-- ========================= -->
                <!-- ìƒˆ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
                <!-- ========================= -->
                <div class="mt-3 text-center">
                    <img id="previewImg"
                         style="display:none;
                                width:250px;
                                border-radius:10px;">
                </div>

                <!-- ========================= -->
                <!-- ì €ì¥ ë²„íŠ¼ -->
                <!-- ========================= -->
                <button type="submit"
                        class="btn btn-dark w-100 mt-4">
                    ì €ì¥
                </button>

            </form>

        </div>
    </div>

</div>

<!-- ========================= -->
<!-- ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° JS -->
<!-- ========================= -->
<script>

function preview(event) {

    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();

    reader.onload = function(e) {

        const img = document.getElementById("previewImg");

        img.src = e.target.result;
        img.style.display = "block";
    };

    reader.readAsDataURL(file);
}

</script>

<div th:replace="layout/footer :: footer"></div>

</body>
</html>